# vim:ft=ansible:
---
- include_tasks: zypper_repositories.yml

- include_tasks: backup.yml

- include_tasks: desktop.yml
  when:
    - suse_desktop_enable|bool

- name: /etc/tmpfiles.d/tmp-clean.conf
  copy:
    content:  "d /tmp 1777 root root 0"
    dest:     "/etc/tmpfiles.d/tmp-clean.conf"
    mode:     0644
    owner:    root
    group:    root

- name: /etc/aliases
  template:
    src:    aliases.j2
    dest:   /etc/aliases
    mode:   0644
    owner:  root
    group:  root
  notify: newaliases
  
- name: Postfix /etc/postfix/main.cf
  template:
    src:    postfix-main.cf.j2
    dest:   /etc/postfix/main.cf
    mode:   0644
    owner:  root
    group:  root
  notify: postfix-reload

- name: ensure services running and enabled
  service: name="{{ item }}" enabled="yes" state="started"
  with_items: "{{ suse_daemons }}"
